{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./_dev/js/payment_pbt.js"],"names":["$","document","ready","hasClass","initPaypalBraintree","on","html","is","flow","paypal_bt_form","querySelector","braintree","client","create","authorization","paypal_braintree","clientErr","clientInstance","console","error","paypalCheckout","paypalCheckoutErr","paypalCheckoutInstance","show","text","paypal","Button","render","env","mode","payment","createPayment","amount","currency","billingAgreementDescription","enableShippingAddress","shippingAddressEditable","onAuthorize","data","actions","tokenizePayment","then","payload","value","nonce","hide","append","details","firstName","lastName","email","onCancel","onError","err","e","click","event","payment_selected","attr","val","preventDefault","stopPropagation","translations","empty_nonce"],"mappings":"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","file":"js/payment_pbt.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./_dev/js/payment_pbt.js\");\n","/**\n * 2007-2019 PrestaShop\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade PrestaShop to newer\n * versions in the future. If you wish to customize PrestaShop for your\n * needs please refer to http://www.prestashop.com for more information.\n *\n * @author    PrestaShop SA <contact@prestashop.com>\n * @copyright 2007-2019 PrestaShop SA\n * @license   http://addons.prestashop.com/en/content/12-terms-and-conditions-of-use\n * International Registered Trademark & Property of PrestaShop SA\n */\n\n$(document).ready(function(){\n    if ($('section#checkout-payment-step').hasClass('js-current-step')) {\n        initPaypalBraintree('checkout');\n    }\n    $(document).on('change', 'input[name=save_account_in_vault]', function(){\n        $('#paypal-button').html('');\n        if ($(this).is(':checked')) {\n            initPaypalBraintree('vault');\n        } else {\n            initPaypalBraintree('checkout');\n        }\n    });\n});\n\nfunction initPaypalBraintree(flow) {\n    var paypal_bt_form = document.querySelector('#paypal-braintree-form');\n\n    braintree.client.create({\n        authorization: paypal_braintree.authorization\n    }, function (clientErr, clientInstance) {\n\n        // Stop if there was a problem creating the client.\n        // This could happen if there is a network error or if the authorization\n        // is invalid.\n        if (clientErr) {\n            console.error('Error creating client:', clientErr);\n            return;\n        }\n\n        // Create a PayPal Checkout component.\n        braintree.paypalCheckout.create({\n            client: clientInstance\n        }, function (paypalCheckoutErr, paypalCheckoutInstance) {\n\n            // Stop if there was a problem creating PayPal Checkout.\n            // This could happen if there was a network error or if it's incorrectly\n            // configured.\n            if (paypalCheckoutErr) {\n                $('#bt-paypal-error-msg').show().text(paypalCheckoutErr);\n                return;\n            }\n\n            paypal.Button.render({\n                env: paypal_braintree.mode, // 'production' or 'sandbox'\n\n                payment: function () {\n                    return paypalCheckoutInstance.createPayment({\n                        flow: flow,\n                        amount : paypal_braintree.amount,\n                        currency : paypal_braintree.currency,\n                        billingAgreementDescription: '',\n                        enableShippingAddress: false,\n                        shippingAddressEditable: false\n                    });\n                },\n\n                onAuthorize: function (data, actions) {\n                    return paypalCheckoutInstance.tokenizePayment(data)\n                        .then(function (payload) {\n                            // Submit `payload.nonce` to your server.\n                            document.querySelector('input#paypal_payment_method_nonce').value = payload.nonce;\n                            $('#paypal-button').hide();\n                            $('#bt-paypal-error-msg').hide();\n                            $('#paypal-vault-info').show().append(payload.details.firstName+' '+payload.details.lastName+' '+payload.details.email);\n\n                        });\n                },\n\n                onCancel: function (data) {\n                   // $('#bt-paypal-error-msg').show().text('checkout.js payment cancelled'+JSON.stringify(data, 0, 2)+'');\n                },\n\n                onError: function (err) {\n                    $('#bt-paypal-error-msg').show().text(err);\n                }\n            }, '#paypal-button').then(function (e) {\n\n            });\n            $('#payment-confirmation button').click(function(event){\n                payment_selected = $('input[name=payment-option]:checked').attr('id');\n                if (!$('#pay-with-'+payment_selected+'-form .payment_module').hasClass('paypal-braintree')) {\n                    return true;\n                }\n                if (!document.querySelector('input#paypal_payment_method_nonce').value && !$('select[name=pbt_vaulting_token]').val()) {\n                    event.preventDefault();\n                    event.stopPropagation();\n                    $('#bt-paypal-error-msg').show().text(paypal_braintree.translations.empty_nonce);\n                }\n            });\n\n\n        });\n\n    });\n}\n"],"sourceRoot":""}